---
title: 如何关联结构体中的各个变量
date: 2018-11-09 20:30:06
tags: [编程语言，C++，C，Qt]
categories: Qt
---


![](http://pgwh8fe8h.bkt.clouddn.com/15417670075439.jpg)
<!--more-->


>日常查询一个结构体里面的变量，一般都是直接拿着结构体往控件填写相应的参数即可，但是实际应用中涉及到查询等操作时，需要根据某个名称获取其他的信息比如，它的相关说明等等。

**思路**：ID和Name 这两变量本身没有任何关联，需要用一种关联容器实现二者关联。即QMap

**本文关键字**：QListView; QStringList; QMap; 信号和槽



**mainwindow.cpp**


```
#include "mainwindow.h"
#include "ui_mainwindow.h"
#include <QMessageBox>
#include <QDebug>
#include <QString>
#include <QMap>

MainWindow::MainWindow(QWidget *parent) :
    QMainWindow(parent),
    ui(new Ui::MainWindow)
{
    ui->setupUi(this);
    init();
}

MainWindow::~MainWindow()
{
    delete ui;
   }


void MainWindow::init()
 {

 m1_sAreaInfo = {"0x1","名称4","防区安全"};
 m2_sAreaInfo = {"0x2","名称5","防区未知"};
 m3_sAreaInfo = {"0x3","名称6","防区安全"};
ItemModel = new QStandardItemModel(this);
QStringList strList;
strList.append(QString::fromStdString(m1_sAreaInfo.ID));
strList.append(QString::fromStdString(m2_sAreaInfo.ID));
strList.append(QString::fromStdString(m3_sAreaInfo.ID));
map.insert("0x1","名称4");
map.insert("0x2","名称5");
map.insert("0x3","名称6");
int nCount = strList.size();
for(int i = 0; i < nCount; i++)
{
   QString string = static_cast<QString>(strList.at(i));
   QStandardItem *item = new QStandardItem(string);
   ItemModel->appendRow(item);

}
ui->listView->setModel(ItemModel);
ui->listView->setFixedSize(200,300);

connect(ui->listView,SIGNAL(clicked( QModelIndex )),this,SLOT(showClick(QModelIndex)));
}

void MainWindow::showClick( QModelIndex index)
{


QString strTemp;
strTemp = index.data().toString();
QMap<QString, QString>::iterator mi;
 // mi = map.find(strTemp);
QString strName = map[strTemp]; //获取键的值


QMessageBox msg;
msg.setText(strName);
msg.exec();
}
```

-------

**mainwindow.h**



```
#ifndef MAINWINDOW_H
#define MAINWINDOW_H

#include <QMainWindow>

#include <QStringListModel>
#include <QStandardItemModel>
#include <QModelIndex>
namespace Ui {
class MainWindow;
}

class MainWindow : public QMainWindow
{
    Q_OBJECT

public:
    explicit MainWindow(QWidget *parent = 0);
    ~MainWindow();

private:
    Ui::MainWindow *ui;


public:
       QStringListModel *Model;
       QStandardItemModel *ItemModel;
       void init();
       struct sAreaInfo
       {
           std::string ID ;	        //ID
           std::string Name  ;		//名称
           std::string Remark;		//说明
       };
        sAreaInfo m1_sAreaInfo;
        sAreaInfo m2_sAreaInfo;
        sAreaInfo m3_sAreaInfo;
        QMap<QString, QString> map;
private slots:
      // void showClick(QModelIndex sAreaInfo);
        void showClick(QModelIndex);

};

#endif // MAINWINDOW_H
```

-------
**main.cpp**


```
#include "mainwindow.h"
#include <QApplication>

int main(int argc, char *argv[])
{
    QApplication a(argc, argv);
    MainWindow w;
    w.show();

    return a.exec();
}
```



-------

打开Qt Creator，拖放一个QListView
![](http://pgwh8fe8h.bkt.clouddn.com/qt.jpg)
运行效果
![](http://pgwh8fe8h.bkt.clouddn.com/qt2.jpg)
以上demo仅供参考




